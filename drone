import cv2
from djitellopy import tello
from time import sleep
drone = tello.Tello()
import keyboard
#connects and turn on camera
drone.connect()
drone.takeoff()
drone.streamon()

cv2.namedWindow("Tello Camera",cv2.WINDOW_NORMAL)

#controls
running = True
while True:
    frame= drone.get_frame_read().frame
    cv2.imshow("drone cotrol",frame)
    cv2.waitKey(.1)
    key = cv2.waitKey(.1) & 0xff
    if keyboard.is_pressed("l"):
        break
    elif keyboard.is_pressed("w"):
        drone.move_forward(30)
    elif keyboard.is_pressed("s"):
        drone.move_back(30)
    elif keyboard.is_pressed("a"):
        drone.move_left(30)
    elif  keyboard.is_pressed("d"):
        drone.move_right(30)
    elif  keyboard.is_pressed("e"):
        drone.rotate_clockwise(30)
    elif  keyboard.is_pressed("q"):
        drone.rotate_counter_clockwise(30)
    elif  keyboard.is_pressed("r"):
        drone.move_up(30)
    elif keyboard.is_pressed("f"):
        drone.move_down(30)
    elif  keyboard.is_pressed("c"):
        drone.flip("b")
        sleep(0.1)
    
drone.land()

cv2.destroyAllWindows()
drone.end()

